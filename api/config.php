<?php
$prodArr=array(
    "Home Loan (RI)"=>"101",
    "Home Loan (NRI)"=>"102",
    "Non-Home Loans"=>"103"
);

$genderArr=array(
    "Male"=>"70101",
    "Female"=>"70102",
    "Others"=>"70103"
);

$stateArr=array(
    "Andhra Pradesh"=>"100001",
    "Bihar"=>"100002",
    "Gujarat"=>"100003",
    "Jharkhand"=>"100004",
    "Karnataka"=>"100005",
    "Kerala"=>"100006",
    "Madhya Pradesh"=>"100007",
    "Maharashtra"=>"100008",
    "Pondicherry"=>"100009",
    "Punjab"=>"100010",
    "Rajasthan"=>"100011",
    "Tamil Nadu"=>"100012",
    "Telangana"=>"100013",
    "Uttar Pradesh"=>"100014",
    "Uttaranchal"=>"100015",
    "West Bengal"=>"100016"
);

$cityArr=array(
    "Anantapur"=>"100017",
    "Chittoor"=>"100018",
    "East Godavari"=>"100019",
    "Guntur"=>"100020",
    "Krishna"=>"100021",
    "Kurnool"=>"100022",
    "Nellore"=>"100023",
    "Prakasam"=>"100024",
    "Srikakulam"=>"100025",
    "Visakhapatnam"=>"100026",
    "Vizianagaram"=>"100027",
    "West Godavari"=>"100028",
    "Y.S.R.Kadapa"=>"100029",
    "Bhagalpur"=>"100030",
    "Gaya"=>"100031",
    "Muzaffarpur"=>"100032",
    "Nalanda"=>"100033",
    "Patna"=>"100034",
    "Rohtas"=>"100035",
    "Saran"=>"100036",
    "Sheikhpura"=>"100037",
    "Vaishali"=>"100038",
    "Ahmedabad"=>"100039",
    "Amreli"=>"100040",
    "Anand"=>"100041",
    "Banas Kantha"=>"100042",
    "Bharuch"=>"100043",
    "Bhavnagar"=>"100044",
    "Botad"=>"100045",
    "Dahod"=>"100046",
    "Dev Bhumi , Dwarka"=>"100047",
    "Gandhi Nagar"=>"100048",
    "Gir Somnath"=>"100049",
    "Gujarat"=>"100050",
    "Himmatnagar "=>"100051",
    "Jamnagar"=>"100052",
    "Junagadh"=>"100053",
    "Kachchh"=>"100054",
    "Kheda"=>"100055",
    "Mehsana"=>"100056",
    "Morbi"=>"100057",
    "Panch Mahal"=>"100058",
    "Patan"=>"100059",
    "Porbandar"=>"100060",
    "Porbander"=>"100061",
    "Rajkot"=>"100062",
    "Sabar Kantha"=>"100063",
    "Surat"=>"100064",
    "Surendranagar"=>"100065",
    "Vadodara"=>"100066",
    "Valsad"=>"100067",
    "Vapi "=>"100068",
    "Bokaro"=>"100069",
    "Dhanbad"=>"100070",
    "East Singhbhum"=>"100071",
    "Ramgarh"=>"100072",
    "Ranchi"=>"100073",
    "Saraikela Kharsawan"=>"100074",
    "West Singhbhum"=>"100075",
    "Ballari"=>"100076",
    "Bangalore"=>"100077",
    "Belagavi"=>"100078",
    "Belgaum"=>"100079",
    "Bellary"=>"100080",
    "Bengaluru Rural"=>"100081",
    "Bengaluru Urban"=>"100082",
    "Bidar"=>"100083",
    "Chamarajanagar"=>"100084",
    "Chikkaballapur"=>"100085",
    "Chitradurga"=>"100086",
    "Davanagere"=>"100087",
    "Davangere"=>"100088",
    "Dharwad"=>"100089",
    "Gadag"=>"100090",
    "Hassan"=>"100091",
    "Haveri"=>"100092",
    "Kalaburagi"=>"100093",
    "Kodagu"=>"100094",
    "Kolar"=>"100095",
    "Koppal"=>"100096",
    "Mandya"=>"100097",
    "Mysore"=>"100098",
    "Mysuru"=>"100099",
    "Raichur"=>"100100",
    "Ramanagar "=>"100101",
    "Shivamogga"=>"100102",
    "Tumakuru"=>"100103",
    "Tumkur"=>"100104",
    "Vijayapura"=>"100105",
    "Yadgiri"=>"100106",
    "Alappuzha"=>"100107",
    "Ernakulam"=>"100108",
    "Idukki"=>"100109",
    "Kannur"=>"100110",
    "Kasaragod"=>"100111",
    "Kollam"=>"100112",
    "Kottayam"=>"100113",
    "Kozhikode"=>"100114",
    "Malappuram "=>"100115",
    "palakkad"=>"100116",
    "Pathanamthitta"=>"100117",
    "Thiruvananthapuram"=>"100118",
    "Thrissur"=>"100119",
    "Barwani"=>"100120",
    "Berasia"=>"100121",
    "Betul"=>"100122",
    "Bhind"=>"100123",
    "Bhopal"=>"100124",
    "Bhurhanpur"=>"100125",
    "Burhanpur"=>"100126",
    "Chhatarpur"=>"100127",
    "Chhindwara"=>"100128",
    "Damoh"=>"100129",
    "Datia"=>"100130",
    "Dewas"=>"100131",
    "Dhar"=>"100132",
    "Guna"=>"100133",
    "Gwalior"=>"100134",
    "Harda"=>"100135",
    "Hoshangabad"=>"100136",
    "Indore"=>"100137",
    "Jabalpur"=>"100138",
    "Jahbua"=>"100139",
    "Jhabua"=>"100140",
    "Katni"=>"100141",
    "Khandwa"=>"100142",
    "Khandwa "=>"100143",
    "Khargone "=>"100144",
    "Mandsaur"=>"100145",
    "Morena"=>"100146",
    "Narsimhapur"=>"100147",
    "Neemach"=>"100148",
    "Raisen"=>"100149",
    "Rajgarh"=>"100150",
    "Ratlam"=>"100151",
    "Rewa"=>"100152",
    "Sagar"=>"100153",
    "Satna"=>"100154",
    "Sehore"=>"100155",
    "Seoni"=>"100156",
    "Shahdol"=>"100157",
    "Shajapur"=>"100158",
    "Sheopur"=>"100159",
    "Shivpuri"=>"100160",
    "Sidhi"=>"100161",
    "Singrauli"=>"100162",
    "Tikamgarh"=>"100163",
    "Ujjain"=>"100164",
    "Vidisha"=>"100165",
    "Ahmadnagar"=>"100166",
    "Akola"=>"100167",
    "Amravati"=>"100168",
    "Aurangabad"=>"100169",
    "Bhandara"=>"100170",
    "Buldhana"=>"100171",
    "Chandrapur"=>"100172",
    "Dhule"=>"100173",
    "Gondia"=>"100174",
    "Hingoli"=>"100175",
    "Jalgaon"=>"100176",
    "Jalna"=>"100177",
    "KOLHAPUR"=>"100178",
    "latur"=>"100179",
    "Mumbai city"=>"100180",
    "Mumbai Suburban"=>"100181",
    "Nagpur"=>"100182",
    "Nanded"=>"100183",
    "Nandurbar"=>"100184",
    "NASHIK"=>"100185",
    "Nashik 1"=>"100186",
    "Osmanabad"=>"100187",
    "Parbhani"=>"100188",
    "Pune"=>"100189",
    "Raigad"=>"100190",
    "Sangali"=>"100191",
    "Satara"=>"100192",
    "Solapur"=>"100193",
    "Thane"=>"100194",
    "Wardha"=>"100195",
    "Washim"=>"100196",
    "Yavatmal"=>"100197",
    "Puducherry"=>"100198",
    "Villupuram"=>"100199",
    "Ambala"=>"100200",
    "Amritsar"=>"100201",
    "Barnala"=>"100202",
    "Bathinda"=>"100203",
    "Chandigarh"=>"100204",
    "Dera bassi"=>"100205",
    "Fatehgarh Sahib"=>"100206",
    "Ferozpur"=>"100207",
    "Ferzopur"=>"100208",
    "Gurdaspur"=>"100209",
    "Hoshiarpur"=>"100210",
    "Jalandhar"=>"100211",
    "Kapurthala"=>"100212",
    "Ludhiana"=>"100213",
    "Mansa"=>"100214",
    "Moga"=>"100215",
    "Mohali"=>"100216",
    "Muktsar"=>"100217",
    "Nawasher"=>"100218",
    "Patiala"=>"100219",
    "Sangrur"=>"100220",
    "Snagruru"=>"100221",
    "Ajmer"=>"100222",
    "Alwar"=>"100223",
    "Banswara"=>"100224",
    "Banswara "=>"100225",
    "Baran"=>"100226",
    "Bhilwara"=>"100227",
    "Bikaner"=>"100228",
    "Bundi"=>"100229",
    "Chittaurgarh"=>"100230",
    "Churu"=>"100231",
    "Dausa"=>"100232",
    "Dungarpur"=>"100233",
    "Ganganagar"=>"100234",
    "Hanumangarh"=>"100235",
    "Jaipur"=>"100236",
    "Jaipur "=>"100237",
    "Jhalawar"=>"100238",
    "Jhunjhunun"=>"100239",
    "Jodhpur"=>"100240",
    "Kota"=>"100241",
    "Nagaur"=>"100242",
    "Pali"=>"100243",
    "Rajsamand"=>"100244",
    "Sawamadhopur"=>"100245",
    "Sikar"=>"100246",
    "Tonk"=>"100247",
    "Udaipur"=>"100248",
    "Ariyalur"=>"100249",
    "Chengalpattu"=>"100250",
    "Chengalpattu "=>"100251",
    "Chennai"=>"100252",
    "Coimbatore"=>"100253",
    "Coimbatore "=>"100254",
    "Cuddalore"=>"100255",
    "Dindigul"=>"100256",
    "Erode"=>"100257",
    "Erode "=>"100258",
    "Kallakurichi"=>"100259",
    "Kancheepuram"=>"100260",
    "Kanyakumari"=>"100261",
    "Karur"=>"100262",
    "Krishnagiri"=>"100263",
    "Madurai"=>"100264",
    "Nagapattinam"=>"100265",
    "Namakkal"=>"100266",
    "Perambalur"=>"100267",
    "Puducherry"=>"100268",
    "Pudukottai"=>"100269",
    "Ramanathapuram"=>"100270",
    "Ranipet"=>"100271",
    "Salem "=>"100272",
    "Sivagangai"=>"100273",
    "Tenkasi"=>"100274",
    "Thanjavur"=>"100275",
    "Theni"=>"100276",
    "Thiruvannamalai"=>"100277",
    "Thiruvarur"=>"100278",
    "Thoothukudi"=>"100279",
    "Tirunelveli"=>"100280",
    "Tirupattur"=>"100281",
    "Tiruppur"=>"100282",
    "Tiruppur "=>"100283",
    "Tiruvallur"=>"100284",
    "Tiruvannamalai"=>"100285",
    "Trichy"=>"100286",
    "Vellore"=>"100287",
    "Villupuram"=>"100288",
    "Virudhunagar"=>"100289",
    "Adilbad"=>"100290",
    "Hyderabad"=>"100291",
    "Karim Nagar"=>"100292",
    "Khammam"=>"100293",
    "Mahe"=>"100294",
    "Medak"=>"100295",
    "Mehbubnagar"=>"100296",
    "Nalgonda"=>"100297",
    "Nizamabad"=>"100298",
    "Rangareddi"=>"100299",
    "Warangal"=>"100300",
    "Agra"=>"100301",
    "Aligarh"=>"100302",
    "Allahabad"=>"100303",
    "Ambedkarnagar"=>"100304",
    "Ayodhya "=>"100305",
    "Azamgarh"=>"100306",
    "Baghpat"=>"100307",
    "Balrampur "=>"100308",
    "Barabanki"=>"100309",
    "bareilly"=>"100310",
    "Basti"=>"100311",
    "Bijnor"=>"100312",
    "Bisalpur"=>"100313",
    "Budaun"=>"100314",
    "Bulandshahr"=>"100315",
    "Bulandshhar"=>"100316",
    "Chandauli"=>"100317",
    "Deoria"=>"100318",
    "Etah"=>"100319",
    "Etawah"=>"100320",
    "Firozabad"=>"100321",
    "GAUTAM BUDH NAGAR "=>"100322",
    "Gautambudh Nagar"=>"100323",
    "GB Nagar"=>"100324",
    "Ghaziabad"=>"100325",
    "Ghaziabad "=>"100326",
    "Ghaziyabad"=>"100327",
    "Gonda"=>"100328",
    "Gorakhpur"=>"100329",
    "Hapur"=>"100330",
    "Hardoi"=>"100331",
    "Haridwar"=>"100332",
    "Hathras"=>"100333",
    "Jalaun"=>"100334",
    "Jaunpur"=>"100335",
    "Jhansi"=>"100336",
    "kanpur dehat"=>"100337",
    "kanpur nagar"=>"100338",
    "Kanpur Rural"=>"100339",
    "Kanpur Urban"=>"100340",
    "Kaushambi"=>"100341",
    "Kushinagar"=>"100342",
    "Lakhimpur "=>"100343",
    "Lalitpur"=>"100344",
    "Lucknow"=>"100345",
    "Maharajganj"=>"100346",
    "Mathura"=>"100347",
    "Meerut"=>"100348",
    "Mirzapur"=>"100349",
    "Moradabad"=>"100350",
    "Muzaffarnagar"=>"100351",
    "NEW DELHI "=>"100352",
    "Pilibhit"=>"100353",
    "Pratapgarh"=>"100354",
    "Rae bareli"=>"100355",
    "Rampur"=>"100356",
    "Saharanpur"=>"100357",
    "Sambhal"=>"100358",
    "Sant Ravi Nagar"=>"100359",
    "Shahjahanpur"=>"100360",
    "Shamali"=>"100361",
    "Sitapur"=>"100362",
    "Sultanpur"=>"100363",
    "Unnao"=>"100364",
    "Varanasi"=>"100365",
    "Dehradun "=>"100366",
    "Haridwar"=>"100367",
    "Nainital"=>"100368",
    "Udhamsinghnagar"=>"100369",
    "Bankura"=>"100370",
    "Birbhum"=>"100371",
    "Darjiling"=>"100372",
    "Haora"=>"100373",
    "Hooghly"=>"100374",
    "Howrah"=>"100375",
    "Jalpaiguri"=>"100376",
    "Kolkata"=>"100377",
    "Murshidabad"=>"100378",
    "Nadia"=>"100379",
    "North 24 Parganas"=>"100380",
    "North24 - Parganas"=>"100381",
    "Paschim Bardhaman"=>"100382",
    "Paschim Midnapore"=>"100383",
    "Purba Bardhaman"=>"100384",
    "Purba Midnapore"=>"100385",
    "Puruliya"=>"100386",
    "South 24 Parganas"=>"100387",
    "South24 - Parganas"=>"100388",
);

$countryArr=array(
    'India'=>'2050052'
);

$loanReqArr=array(
    "In 1 to 7 Days"=>"2050072",
    "In 8 - 15 Days"=>"2050073",
    "After 15 Days"=>"2050074",
);

$refTypeArr=array(
    "Employee"=>'2050062',
    "Customer"=>'2050065'
);

$leadOccupArr=array(
    "Salaried - Bank credit"=>"80501",
    "Salaried - Cash"=>"80502",
    "SENP - No income Proof"=>"80503",
    "SENP - Regualar ITR"=>"80504",
    "SEP - No income Proof"=>"80505",
    "SEP - Regualar ITR"=>"80506",
);

$loanPurposeArr=array(
    "Self Use"=>'121',
    "Investment"=>'122',
    "Commercial Purpose"=>'123',
);

$doYouArr['Friend']='2050082';

$referralArr=array(
    "Social Media"=>"2050003",
    "Campaign"=>"2050004",
    "Branch Walk-in"=>"2050002",
    "Website"=>"2050005"
);

function curlPost($url,$data,$headerArr,$encodeType)
{
    $encodedString='';
    if($encodeType=='urlencoded')
    {
        foreach ($data as $key => $value) {
            $value = strtr($value, ['&' => '%26']);
            $encodedString .= "&$key=$value";
        }
    }
    if($encodeType=='json')
    {
        $encodedString=json_encode($data);
    }
    $ch = curl_init();
    curl_setopt($ch, CURLOPT_URL,$url);
    curl_setopt($ch, CURLOPT_POST, 1);
    curl_setopt($ch, CURLOPT_POSTFIELDS,$encodedString);
    curl_setopt($ch, CURLOPT_HTTPHEADER, $headerArr);
    curl_setopt($ch, CURLOPT_PROXY, '10.130.1.1');
    curl_setopt($ch, CURLOPT_PROXYPORT, '8080');
    // In real life you should use something like:
    // curl_setopt($ch, CURLOPT_POSTFIELDS, 
    //          http_build_query(array('postvar1' => 'value1')));

    // Receive server response ...
    curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
    $server_output = curl_exec($ch);
    curl_close ($ch);
    return (array) json_decode($server_output);
    // Further processing ...
    // if ($server_output == "OK") { ... } else { ... }
}

function createToken($length)
{
    $url='https://amwuat.aadharhousing.com/token';
    //$url='https://10.121.1.7:8247/token';
    $postArr=array(
        'grant_type'=>'client_credentials'
    );
	if($length>8)
		$headerArr=array(
			'Content-Type: application/x-www-form-urlencoded',
			'Authorization: Basic eDNPUzNLdEFGUTB5ZUVWbGpyZlpySldjXzU0YTpLYjNoTzVSM0RmcUY4NFppRXRibnhkdlN3YVFh'
		);
	else
		$headerArr=array(
			'Content-Type: application/x-www-form-urlencoded',
			'Authorization: Basic dmhiZGFZM3dVbFJqZ19ydHNQQTVzX0xCMW40YTo3THNlZUNlNTg1cUk0cWtzZmhxeE1sQ1V0bEFh'
		);
    $encodeType="urlencoded";
    
    $response=curlPost($url,$postArr,$headerArr,$encodeType);
    $token=(isset($response['access_token']) && !empty($response['access_token']))?$response['access_token']:'';
    return $token;
}

function getMandateStatus($app_no,$dob,$token)
{
    $url='https://amwuat.aadharhousing.com/uat/achmandate/1.0/achmandate_status';
    //$url='https://10.121.1.7:8247/uat/achmandate/1.0/achmandate_status';

    $postArr=array(
        'application_id'=>$app_no,
        'date_of_birth'=>$dob
    );
    $headerArr=array(
        'Content-Type: application/json',
        'Authorization: Bearer '.$token
    );
    $encodeType="json";
    
    $response=curlPost($url,$postArr,$headerArr,$encodeType);
    return $response;
}

function getMandateDetails($app_no,$token)
{
    $url='https://amwuat.aadharhousing.com/uat/achmandatedetails/1.0/achmandate_details';
    $postArr=array(
        'application_id'=>$app_no
    );
    $headerArr=array(
        'Content-Type: application/json',
        'Authorization: Bearer '.$token
    );
    $encodeType="json";
    
    $response=curlPost($url,$postArr,$headerArr,$encodeType);
    return $response;
}
function registerMandateProcess($post_arr=array())
{
    $url='https://api-test.lotuspay.com/v1/sources';
    $postArr=array(
        "type" => "nach_debit", 
        "nach_debit" => array(
            "amount_maximum" => $post_arr['amount'], 
            "date_first_collection" => $post_arr['start_date'], 
            "debtor_account_name" => $post_arr['ap_bankholder'], 
            "debtor_account_number" => $post_arr['ap_bankaccount'],  
            "debtor_account_type" => $post_arr['account_type'], 
            "debtor_agent_mmbid" => $post_arr['ifsc_code'],  
            "debtor_email" => $post_arr['email_id'],  
            "debtor_mobile" => $post_arr['mobile_number'], 
            "frequency" => $post_arr['frequency'],  
            "reference1" => $post_arr['reference1'], 
            "reference2" =>trim($post_arr['reference2']),
            "variant" => $post_arr['variant'],  
            "creditor_agent_code" => $post_arr['creditor_agent_code'], 
            "creditor_utility_code" => $post_arr['creditor_utility_code'] 
        )
    );
    $headerArr=array(
        'Content-Type: application/json',
        'Authorization: Basic c2tfdGVzdF8zRXFwd0ZhWlp4TXg1empzMWF6TlBFNDE6'
    );
    $encodeType="json";
    
    $response=curlPost($url,$postArr,$headerArr,$encodeType);
    return $response;
}
?>